name: Auto Create PR on Push
on:
  push:
    branches:
      - test  # 监听 test 分支的提交

jobs:
  create-pr:
    runs-on: ubuntu-latest
    permissions:
      contents: write  
      pull-requests: write
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          ref: ${{ github.sha }}  # 检出当前提交的代码

      - name: Generate Changes (示例：修改 README)
        run: |
          echo "# Updated at $(date)" >> README.md  
          git config user.name "1309959633-github-actions"  
          git config user.email "1309959633@qq.com"

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: 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  # 使用内置 token
          branch: auto-pr-${{ github.run_id }}  # 动态生成唯一分支名，避免重复
          base: main  # 目标合并分支
          title: "Automated PR: Updates from ${{ github.sha }}"
          body: |  # PR 描述模板
            This PR was auto-generated by GitHub Actions.
          commit-message: "chore: auto-update via GitHub Actions"
